# woolf-de-hw-04

# Apache Spark: Optimization and SparkUI Analysis

## üìã –û–ø–∏—Å –∑–∞–≤–¥–∞–Ω–Ω—è

–¶–µ –¥–æ–º–∞—à–Ω—î –∑–∞–≤–¥–∞–Ω–Ω—è –∑ –∫—É—Ä—Å—É Data Engineering –ø—Ä–∏—Å–≤—è—á–µ–Ω–µ –≤–∏–≤—á–µ–Ω–Ω—é –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó Apache Spark —á–µ—Ä–µ–∑ –∞–Ω–∞–ª—ñ–∑ SparkUI. –ú–∏ –¥–æ—Å–ª—ñ–¥–∂—É—î–º–æ –≤–ø–ª–∏–≤ lazy evaluation, –ø—Ä–æ–º—ñ–∂–Ω–∏—Ö actions —Ç–∞ –∫–µ—à—É–≤–∞–Ω–Ω—è –Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å Jobs —É Spark.

## üéØ –ú–µ—Ç–∞ —Ä–æ–±–æ—Ç–∏

- –ó—Ä–æ–∑—É–º—ñ—Ç–∏ —Ä—ñ–∑–Ω–∏—Ü—é –º—ñ–∂ lazy evaluation —Ç–∞ actions —É Spark
- –ù–∞–≤—á–∏—Ç–∏—Å—è –∞–Ω–∞–ª—ñ–∑—É–≤–∞—Ç–∏ SparkUI –¥–ª—è –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ
- –î–æ—Å–ª—ñ–¥–∏—Ç–∏ –≤–ø–ª–∏–≤ —Ñ—É–Ω–∫—Ü—ñ—ó `cache()` –Ω–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∑–∞–≤–¥–∞–Ω—å
- –ü–æ—Ä—ñ–≤–Ω—è—Ç–∏ —Ä—ñ–∑–Ω—ñ —Å—Ç—Ä–∞—Ç–µ–≥—ñ—ó –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó —á–µ—Ä–µ–∑ –∫—ñ–ª—å–∫—ñ—Å—Ç—å Jobs

## üìä –î–∞—Ç–∞—Å–µ—Ç

- **–§–∞–π–ª**: `nuek-vuh3.csv`
- **–†–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è**: `data/nuek-vuh3.csv`
- **–û–ø–∏—Å**: –î–∞—Ç–∞—Å–µ—Ç –∑ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—î—é –ø—Ä–æ —ñ–Ω—Ü–∏–¥–µ–Ω—Ç–∏ –∑ –ø–æ–ª—è–º–∏ unit_id, final_priority —Ç–∞ —ñ–Ω—à–∏–º–∏

## üõ†Ô∏è –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞

### –í–∏–º–æ–≥–∏
- Python 3.8+
- Java 8 –∞–±–æ 11
- Apache Spark 3.5.0
- WSL2 (–¥–ª—è Windows)

### –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è

1. **–ö–ª–æ–Ω—É–≤–∞–Ω–Ω—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é:**
```bash
git clone https://github.com/yourusername/woolf-de-hw-04.git
cd woolf-de-hw-04
```

2. **–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Java (WSL):**
```bash
sudo apt update
sudo apt install openjdk-11-jdk
export JAVA_HOME=/usr/lib/jvm/java-11-openjdk-amd64
export PATH=$JAVA_HOME/bin:$PATH
```

3. **–°—Ç–≤–æ—Ä–µ–Ω–Ω—è –≤—ñ—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞:**
```bash
python3 -m venv venv
source venv/bin/activate
```

4. **–í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π:**
```bash
pip install -r requirements.txt
```

## üöÄ –í–∏–∫–æ–Ω–∞–Ω–Ω—è –∑–∞–≤–¥–∞–Ω—å

### –ó–∞–≤–¥–∞–Ω–Ω—è 1: –ë–∞–∑–æ–≤–∞ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü—ñ—è (7 Jobs)

–î–µ–º–æ–Ω—Å—Ç—Ä—É—î lazy evaluation - –≤—Å—ñ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü—ñ—ó –≤–∏–∫–æ–Ω—É—é—Ç—å—Å—è —Ä–∞–∑–æ–º –ø—Ä–∏ –≤–∏–∫–ª–∏–∫—É `collect()`.

```bash
python src/task1_basic_transformation.py
```

**–û—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ –∫–æ–¥—É:**
- –î–æ–¥–∞—Ç–∫–æ–≤–∞ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è `where("count>2")` –ø—ñ—Å–ª—è –≥—Ä—É–ø—É–≤–∞–Ω–Ω—è
- –Ñ–¥–∏–Ω–∏–π –≤–∏–∫–ª–∏–∫ `collect()` –≤ –∫—ñ–Ω—Ü—ñ
- –í—Å—ñ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü—ñ—ó –≤–∏–∫–æ–Ω—É—é—Ç—å—Å—è –≤ –æ–¥–Ω–æ–º—É –ª–∞–Ω—Ü—é–∂–∫—É

**–†–µ–∑—É–ª—å—Ç–∞—Ç SparkUI:**

![Task 1 - 5 Jobs](screenshots/task1_7_jobs.png)
*–°–∫—Ä—ñ–Ω—à–æ—Ç 1: –ë–∞–∑–æ–≤–∞ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü—ñ—è –∑ lazy evaluation - 7 Jobs*

---

### –ó–∞–≤–¥–∞–Ω–Ω—è 2: –ü—Ä–æ–º—ñ–∂–Ω–∞ –¥—ñ—è –±–µ–∑ –∫–µ—à—É–≤–∞–Ω–Ω—è (10 Jobs)

–ü–æ–∫–∞–∑—É—î –≤–ø–ª–∏–≤ –ø—Ä–æ–º—ñ–∂–Ω–∏—Ö actions –±–µ–∑ –∫–µ—à—É–≤–∞–Ω–Ω—è, —â–æ –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è.

```bash
python src/task2_intermediate_action.py
```

**–û—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ –∫–æ–¥—É:**
- –î–≤–∞ –≤–∏–∫–ª–∏–∫–∏ `collect()` - –¥–æ —ñ –ø—ñ—Å–ª—è –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó
- –ë–µ–∑ –∫–µ—à—É–≤–∞–Ω–Ω—è Spark –ø–µ—Ä–µ–≤–∏–∫–æ–Ω—É—î –≤–µ—Å—å pipeline
- –î–æ–¥–∞—Ç–∫–æ–≤—ñ Jobs —á–µ—Ä–µ–∑ –ø–æ–≤—Ç–æ—Ä–Ω–µ —á–∏—Ç–∞–Ω–Ω—è —Ç–∞ –æ–±—Ä–æ–±–∫—É –¥–∞–Ω–∏—Ö

**–†–µ–∑—É–ª—å—Ç–∞—Ç SparkUI:**

![Task 2 - 8 Jobs](screenshots/task2_10_jobs.png)
*–°–∫—Ä—ñ–Ω—à–æ—Ç 2: –ü—Ä–æ–º—ñ–∂–Ω–∞ –¥—ñ—è –±–µ–∑ –∫–µ—à—É–≤–∞–Ω–Ω—è - 10 Jobs*

---

### –ó–∞–≤–¥–∞–Ω–Ω—è 3: –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è cache() (9 Jobs)

–î–µ–º–æ–Ω—Å—Ç—Ä—É—î –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—é —á–µ—Ä–µ–∑ –∫–µ—à—É–≤–∞–Ω–Ω—è –ø—Ä–æ–º—ñ–∂–Ω–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤.

```bash
python src/task3_with_cache.py
```

**–û—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ –∫–æ–¥—É:**
- –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è `.cache()` –ø—ñ—Å–ª—è –≥—Ä—É–ø—É–≤–∞–Ω–Ω—è
- –ü–µ—Ä—à–∏–π `collect()` –∑–±–µ—Ä—ñ–≥–∞—î –¥–∞–Ω—ñ –≤ –ø–∞–º'—è—Ç—ñ
- –î—Ä—É–≥–∏–π `collect()` –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –∫–µ—à–æ–≤–∞–Ω—ñ –¥–∞–Ω—ñ

**–†–µ–∑—É–ª—å—Ç–∞—Ç SparkUI:**

![Task 3 - 7 Jobs](screenshots/task3_9_jobs.png)
*–°–∫—Ä—ñ–Ω—à–æ—Ç 3: –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è –∑ cache() - 9 Jobs*

## üìà –ü–æ—Ä—ñ–≤–Ω—è–ª—å–Ω–∏–π –∞–Ω–∞–ª—ñ–∑

| –ó–∞–≤–¥–∞–Ω–Ω—è | –ö—ñ–ª—å–∫—ñ—Å—Ç—å Jobs | –ü–æ—è—Å–Ω–µ–Ω–Ω—è |
|----------|---------------|-----------|
| **Task 1** | 7 | Lazy evaluation - –≤—Å—ñ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü—ñ—ó –≤ –æ–¥–Ω–æ–º—É –≤–∏–∫–æ–Ω–∞–Ω–Ω—ñ |
| **Task 2** | 10 | –ü–æ–≤—Ç–æ—Ä–Ω–µ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —á–µ—Ä–µ–∑ –≤—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å –∫–µ—à—É–≤–∞–Ω–Ω—è |
| **Task 3** | 9 | –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è –∑–∞–≤–¥—è–∫–∏ cache() - –º–µ–Ω—à–µ –ø–æ–≤—Ç–æ—Ä–Ω–∏—Ö –æ–±—á–∏—Å–ª–µ–Ω—å |

## üîç –ö–ª—é—á–æ–≤—ñ –≤–∏—Å–Ω–æ–≤–∫–∏

### Lazy Evaluation
- Spark –≤—ñ–¥–∫–ª–∞–¥–∞—î –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –¥–æ –≤–∏–∫–ª–∏–∫—É action
- –û–ø—Ç–∏–º—ñ–∑—É—î –ø–ª–∞–Ω –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º
- –ó–º–µ–Ω—à—É—î –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø—Ä–æ—Ö–æ–¥—ñ–≤ –ø–æ –¥–∞–Ω–∏—Ö

### –§—É–Ω–∫—Ü—ñ—è cache()
- **–ü–µ—Ä–µ–≤–∞–≥–∏:**
  - –ó–±–µ—Ä—ñ–≥–∞—î –ø—Ä–æ–º—ñ–∂–Ω—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –≤ –ø–∞–º'—è—Ç—ñ
  - –£–Ω–∏–∫–∞—î –ø–æ–≤—Ç–æ—Ä–Ω–∏—Ö –æ–±—á–∏—Å–ª–µ–Ω—å
  - –ü—Ä–∏—Å–∫–æ—Ä—é—î –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –ø—Ä–∏ –º–Ω–æ–∂–∏–Ω–Ω–∏—Ö –¥—ñ—è—Ö
  
- **–ö–æ–ª–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏:**
  - –Ü—Ç–µ—Ä–∞—Ç–∏–≤–Ω—ñ –∞–ª–≥–æ—Ä–∏—Ç–º–∏
  - –ú–Ω–æ–∂–∏–Ω–Ω—ñ actions –Ω–∞ –æ–¥–Ω–æ–º—É DataFrame
  - –î–æ—Ä–æ–≥—ñ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –ø–æ–≤—Ç–æ—Ä–Ω–æ

### –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è Jobs
- –ú–µ–Ω—à–µ Jobs ‚â† –∑–∞–≤–∂–¥–∏ –∫—Ä–∞—â–∞ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å
- –í–∞–∂–ª–∏–≤–æ –≤—Ä–∞—Ö–æ–≤—É–≤–∞—Ç–∏ —Å–∫–ª–∞–¥–Ω—ñ—Å—Ç—å –∫–æ–∂–Ω–æ–≥–æ Job
- Cache –º–∞—î —Å–µ–Ω—Å –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º—É –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—ñ –¥–∞–Ω–∏—Ö

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç—É

```
woolf-de-hw-04/
‚îú‚îÄ‚îÄ README.md                    # –¶–µ–π —Ñ–∞–π–ª
‚îú‚îÄ‚îÄ requirements.txt              # Python –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ
‚îú‚îÄ‚îÄ .gitignore                   # Git –≤–∏–∫–ª—é—á–µ–Ω–Ω—è
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îî‚îÄ‚îÄ nuek-vuh3.csv           # –î–∞—Ç–∞—Å–µ—Ç
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ task1_basic_transformation.py
‚îÇ   ‚îú‚îÄ‚îÄ task2_intermediate_action.py
‚îÇ   ‚îî‚îÄ‚îÄ task3_with_cache.py
‚îú‚îÄ‚îÄ screenshots/
‚îÇ   ‚îú‚îÄ‚îÄ task1_7_jobs.png
‚îÇ   ‚îú‚îÄ‚îÄ task2_10_jobs.png
‚îÇ   ‚îî‚îÄ‚îÄ task3_9_jobs.png
‚îî‚îÄ‚îÄ docs/
    ‚îî‚îÄ‚îÄ analysis.md              # –î–µ—Ç–∞–ª—å–Ω–∏–π –∞–Ω–∞–ª—ñ–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤
```

## ‚ö†Ô∏è –í–∞–∂–ª–∏–≤—ñ –Ω–æ—Ç–∞—Ç–∫–∏

- **–ü–æ—Ä—Ç 4040**: –Ø–∫—â–æ –∑–∞–π–Ω—è—Ç–∏–π, Spark –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—î 4041, 4042...
- **–ü–∞–º'—è—Ç—å**: –ü—Ä–∏ —Ä–æ–±–æ—Ç—ñ –∑ –≤–µ–ª–∏–∫–∏–º–∏ –¥–∞—Ç–∞—Å–µ—Ç–∞–º–∏ –º–æ–∂–µ –∑–Ω–∞–¥–æ–±–∏—Ç–∏—Å—è –∑–±—ñ–ª—å—à–∏—Ç–∏ heap size
- **WSL Path**: –°–∫—Ä–∏–ø—Ç–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏–∑–Ω–∞—á–∞—é—Ç—å —à–ª—è—Ö –¥–ª—è WSL

## üìö –î–æ–¥–∞—Ç–∫–æ–≤—ñ —Ä–µ—Å—É—Ä—Å–∏

- [Apache Spark Documentation](https://spark.apache.org/docs/latest/)
- [SparkUI Guide](https://spark.apache.org/docs/latest/web-ui.html)
- [RDD Programming Guide](https://spark.apache.org/docs/latest/rdd-programming-guide.html)
