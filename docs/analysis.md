# –î–µ—Ç–∞–ª—å–Ω–∏–π –∞–Ω–∞–ª—ñ–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ SparkUI

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—É

### –§–∞–∫—Ç–∏—á–Ω—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏
- **Task 1 (–ë–∞–∑–æ–≤–∞ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü—ñ—è):** 7 Jobs
- **Task 2 (–ü—Ä–æ–º—ñ–∂–Ω–∞ –¥—ñ—è):** 10 Jobs  
- **Task 3 (–ó –∫–µ—à—É–≤–∞–Ω–Ω—è–º):** 9 Jobs

## üîç –î–µ—Ç–∞–ª—å–Ω–∏–π –∞–Ω–∞–ª—ñ–∑ –∫–æ–∂–Ω–æ–≥–æ –∑–∞–≤–¥–∞–Ω–Ω—è

### Task 1: –ë–∞–∑–æ–≤–∞ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü—ñ—è - 7 Jobs

#### –†–æ–∑–±–∏—Ç—Ç—è Jobs:
1. **Job 0-1:** –ß–∏—Ç–∞–Ω–Ω—è CSV —Ñ–∞–π–ª—É —Ç–∞ –ø–æ—á–∞—Ç–∫–æ–≤–∞ –æ–±—Ä–æ–±–∫–∞ —Å—Ö–µ–º–∏
2. **Job 2:** –ü—ñ–¥—Ä–∞—Ö—É–Ω–æ–∫ —Ä—è–¥–∫—ñ–≤ –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ (`nuek_df.count()`)
3. **Job 3:** Repartition –¥–∞–Ω–∏—Ö –Ω–∞ 2 –ø–∞—Ä—Ç–∏—Ü—ñ—ó
4. **Job 4-5:** –í–∏–∫–æ–Ω–∞–Ω–Ω—è —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó, –≥—Ä—É–ø—É–≤–∞–Ω–Ω—è —Ç–∞ –∞–≥—Ä–µ–≥–∞—Ü—ñ—ó
5. **Job 6:** –§—ñ–Ω–∞–ª—å–Ω–∏–π collect() –∑ –¥–æ–¥–∞—Ç–∫–æ–≤–æ—é —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—î—é

#### –ö–ª—é—á–æ–≤—ñ —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—è:
- Lazy evaluation –¥–æ–∑–≤–æ–ª—è—î Spark –æ–ø—Ç–∏–º—ñ–∑—É–≤–∞—Ç–∏ –≤–µ—Å—å pipeline
- –í—Å—ñ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü—ñ—ó (where, select, groupBy, count, where) –≤–∏–∫–æ–Ω—É—é—Ç—å—Å—è –≤ –æ–¥–Ω–æ–º—É –ª–∞–Ω—Ü—é–∂–∫—É
- –î–æ–¥–∞—Ç–∫–æ–≤–∞ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è `where("count > 2")` –Ω–µ —Å—Ç–≤–æ—Ä—é—î –Ω–æ–≤–∏—Ö Jobs

---

### Task 2: –ü—Ä–æ–º—ñ–∂–Ω–∞ –¥—ñ—è –±–µ–∑ –∫–µ—à—É–≤–∞–Ω–Ω—è - 10 Jobs

#### –†–æ–∑–±–∏—Ç—Ç—è Jobs:
1. **Jobs 0-1:** –ü–æ—á–∞—Ç–∫–æ–≤–µ —á–∏—Ç–∞–Ω–Ω—è CSV
2. **Job 2:** Count –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ
3. **Job 3:** Repartition
4. **Jobs 4-6:** –ü–µ—Ä—à–∏–π collect() - –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –≤—Å—ñ—Ö —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü—ñ–π
5. **Jobs 7-9:** –î—Ä—É–≥–∏–π collect() - **–ø–æ–≤—Ç–æ—Ä–Ω–µ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –≤—Å—å–æ–≥–æ pipeline**

#### –ö–ª—é—á–æ–≤—ñ —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—è:
- –ë–µ–∑ –∫–µ—à—É–≤–∞–Ω–Ω—è Spark –ø–æ–≤—Ç–æ—Ä–Ω–æ –≤–∏–∫–æ–Ω—É—î –≤—Å—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó
- –ö–æ–∂–µ–Ω collect() –∑–∞–ø—É—Å–∫–∞—î –ø–æ–≤–Ω–µ –ø–µ—Ä–µ—á–∏—Ç—É–≤–∞–Ω–Ω—è —Ç–∞ –æ–±—Ä–æ–±–∫—É –¥–∞–Ω–∏—Ö
- –¶–µ –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ –¥—É–±–ª—é–≤–∞–Ω–Ω—è –æ–±—á–∏—Å–ª–µ–Ω—å —Ç–∞ –∑–±—ñ–ª—å—à–µ–Ω–Ω—è —á–∞—Å—É –≤–∏–∫–æ–Ω–∞–Ω–Ω—è

---

### Task 3: –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è cache() - 9 Jobs

#### –†–æ–∑–±–∏—Ç—Ç—è Jobs:
1. **Jobs 0-1:** –ü–æ—á–∞—Ç–∫–æ–≤–µ —á–∏—Ç–∞–Ω–Ω—è CSV
2. **Job 2:** Count –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ
3. **Job 3:** Repartition
4. **Jobs 4-6:** –ü–µ—Ä—à–∏–π collect() –∑ –∫–µ—à—É–≤–∞–Ω–Ω—è–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É
5. **Jobs 7-8:** –î—Ä—É–≥–∏–π collect() - **–≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∫–µ—à–æ–≤–∞–Ω–∏—Ö –¥–∞–Ω–∏—Ö**

#### –ö–ª—é—á–æ–≤—ñ —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—è:
- Cache() –∑–±–µ—Ä—ñ–≥–∞—î –ø—Ä–æ–º—ñ–∂–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—ñ—Å–ª—è groupBy().count()
- –î—Ä—É–≥–∏–π collect() –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –¥–∞–Ω—ñ –∑ –ø–∞–º'—è—Ç—ñ, –∞ –Ω–µ –ø–µ—Ä–µ–≤–∏–∫–æ–Ω—É—î –≤–µ—Å—å pipeline
- –ï–∫–æ–Ω–æ–º—ñ—è: 1 Job –ø–æ—Ä—ñ–≤–Ω—è–Ω–æ –∑ Task 2 (9 vs 10 Jobs)

## üìà –ü–æ—Ä—ñ–≤–Ω—è–ª—å–Ω–∏–π –∞–Ω–∞–ª—ñ–∑ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ

### –ï—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –∫–µ—à—É–≤–∞–Ω–Ω—è:

| –ú–µ—Ç—Ä–∏–∫–∞ | Task 2 (–±–µ–∑ cache) | Task 3 (–∑ cache) | –ü–æ–∫—Ä–∞—â–µ–Ω–Ω—è |
|---------|-------------------|------------------|------------|
| –ö—ñ–ª—å–∫—ñ—Å—Ç—å Jobs | 10 | 9 | -10% |
| –ü–æ–≤—Ç–æ—Ä–Ω—ñ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è | –¢–∞–∫ | –ù—ñ | ‚úÖ |
| –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –ø–∞–º'—è—Ç—ñ | –ù–∏–∑—å–∫–µ | –í–∏—â–µ | ‚ö†Ô∏è |
| –ß–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è (–≤—ñ–¥–Ω–æ—Å–Ω–∏–π) | –î–æ–≤—à–µ | –®–≤–∏–¥—à–µ | ‚úÖ |

### –ß–æ–º—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –≤—ñ–¥—Ä—ñ–∑–Ω—è—é—Ç—å—Å—è –≤—ñ–¥ –æ—á—ñ–∫—É–≤–∞–Ω–∏—Ö (5, 8, 7)?

–ú–æ–∂–ª–∏–≤—ñ –ø—Ä–∏—á–∏–Ω–∏:
1. **–í–µ—Ä—Å—ñ—è Spark:** –†—ñ–∑–Ω—ñ –≤–µ—Ä—Å—ñ—ó –º–æ–∂—É—Ç—å –º–∞—Ç–∏ —Ä—ñ–∑–Ω—ñ –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó
2. **–î–æ–¥–∞—Ç–∫–æ–≤—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó:** Count –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ –¥–∞–Ω–∏—Ö –¥–æ–¥–∞—î Jobs
3. **–ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è:** –ü–∞—Ä–∞–º–µ—Ç—Ä–∏ shuffle.partitions –≤–ø–ª–∏–≤–∞—é—Ç—å –Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å Jobs
4. **–†–æ–∑–º—ñ—Ä –¥–∞–Ω–∏—Ö:** –ú–∞–ª—ñ –¥–∞—Ç–∞—Å–µ—Ç–∏ –º–æ–∂—É—Ç—å –æ–±—Ä–æ–±–ª—è—Ç–∏—Å—è —ñ–Ω–∞–∫—à–µ

## üí° –ö–ª—é—á–æ–≤—ñ –≤–∏—Å–Ω–æ–≤–∫–∏

### 1. Lazy Evaluation (Task 1)
- ‚úÖ –î–æ–∑–≤–æ–ª—è—î Spark –æ–ø—Ç–∏–º—ñ–∑—É–≤–∞—Ç–∏ –≤–µ—Å—å –ø–ª–∞–Ω –≤–∏–∫–æ–Ω–∞–Ω–Ω—è
- ‚úÖ –ú—ñ–Ω—ñ–º—ñ–∑—É—î –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø—Ä–æ—Ö–æ–¥—ñ–≤ –ø–æ –¥–∞–Ω–∏—Ö
- ‚úÖ –û–±'—î–¥–Ω—É—î —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü—ñ—ó –≤ —î–¥–∏–Ω–∏–π pipeline

### 2. –í–ø–ª–∏–≤ –ø—Ä–æ–º—ñ–∂–Ω–∏—Ö Actions (Task 2)
- ‚ö†Ô∏è –ö–æ–∂–µ–Ω action –∑–∞–ø—É—Å–∫–∞—î –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –≤—Å—å–æ–≥–æ –ª–∞–Ω—Ü—é–∂–∫–∞
- ‚ö†Ô∏è –ë–µ–∑ –∫–µ—à—É–≤–∞–Ω–Ω—è –¥–∞–Ω—ñ –ø–µ—Ä–µ—á–∏—Ç—É—é—Ç—å—Å—è —Ç–∞ –ø–µ—Ä–µ–æ–±—Ä–æ–±–ª—è—é—Ç—å—Å—è
- ‚ùå –ù–µ–µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–∏—Ö –æ–ø–µ—Ä–∞—Ü—ñ–π –Ω–∞ —Ç–∏—Ö —Å–∞–º–∏—Ö –¥–∞–Ω–∏—Ö

### 3. –ü–µ—Ä–µ–≤–∞–≥–∏ Cache() (Task 3)
- ‚úÖ –ó–±–µ—Ä—ñ–≥–∞—î –ø—Ä–æ–º—ñ–∂–Ω—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –≤ –ø–∞–º'—è—Ç—ñ
- ‚úÖ –£–Ω–∏–∫–∞—î –ø–æ–≤—Ç–æ—Ä–Ω–∏—Ö –æ–±—á–∏—Å–ª–µ–Ω—å
- ‚úÖ –û—Å–æ–±–ª–∏–≤–æ –∫–æ—Ä–∏—Å–Ω–æ –¥–ª—è —ñ—Ç–µ—Ä–∞—Ç–∏–≤–Ω–∏—Ö –∞–ª–≥–æ—Ä–∏—Ç–º—ñ–≤
- ‚ö†Ô∏è –ü–æ—Ç—Ä–µ–±—É—î –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó –ø–∞–º'—è—Ç—ñ

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó –¥–ª—è –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó

1. **–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ cache() –∫–æ–ª–∏:**
   - –û–¥–∏–Ω DataFrame –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –∫—ñ–ª—å–∫–∞ —Ä–∞–∑—ñ–≤
   - –í–∏–∫–æ–Ω—É—é—Ç—å—Å—è —ñ—Ç–µ—Ä–∞—Ç–∏–≤–Ω—ñ –∞–ª–≥–æ—Ä–∏—Ç–º–∏
   - –ü—Ä–æ–º—ñ–∂–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–æ—Ä–æ–≥–∏–π –≤ –æ–±—á–∏—Å–ª–µ–Ω–Ω—ñ

2. **–£–Ω–∏–∫–∞–π—Ç–µ cache() –∫–æ–ª–∏:**
   - DataFrame –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –ª–∏—à–µ –æ–¥–∏–Ω —Ä–∞–∑
   - –î–∞–Ω—ñ –∑–∞–Ω–∞–¥—Ç–æ –≤–µ–ª–∏–∫—ñ –¥–ª—è –ø–∞–º'—è—Ç—ñ
   - –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ—Å—Ç—ñ —Ç–∞ —à–≤–∏–¥–∫—ñ

3. **–ó–∞–≥–∞–ª—å–Ω—ñ –ø–æ—Ä–∞–¥–∏:**
   - –ú—ñ–Ω—ñ–º—ñ–∑—É–π—Ç–µ –∫—ñ–ª—å–∫—ñ—Å—Ç—å actions
   - –ì—Ä—É–ø—É–π—Ç–µ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø–µ—Ä–µ–¥ actions
   - –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ `persist()` –∑ —Ä—ñ–∑–Ω–∏–º–∏ —Ä—ñ–≤–Ω—è–º–∏ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –¥–ª—è –≤–µ–ª–∏–∫–∏—Ö –¥–∞–Ω–∏—Ö
   - –ó–∞–≤–∂–¥–∏ –≤–∏–∫–ª–∏–∫–∞–π—Ç–µ `unpersist()` –ø—ñ—Å–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∫–µ—à—É

## üìö –î–æ–¥–∞—Ç–∫–æ–≤—ñ —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—è

### SparkUI —è–∫ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏:
- **Jobs tab:** –ü–æ–∫–∞–∑—É—î –∑–∞–≥–∞–ª—å–Ω—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Ç–∞ —Å—Ç–∞—Ç—É—Å Jobs
- **Stages tab:** –î–µ—Ç–∞–ª—å–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –∫–æ–∂–µ–Ω Stage
- **Storage tab:** –í—ñ–¥–æ–±—Ä–∞–∂–∞—î –∑–∞–∫–µ—à–æ–≤–∞–Ω—ñ RDD/DataFrames
- **Environment tab:** –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è Spark —Å–µ—Å—ñ—ó

### –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è –¥–ª—è production:
- –ù–∞–ª–∞—à—Ç—É–π—Ç–µ `spark.sql.shuffle.partitions` –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ –¥–æ —Ä–æ–∑–º—ñ—Ä—É –¥–∞–Ω–∏—Ö
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ `coalesce()` –∑–∞–º—ñ—Å—Ç—å `repartition()` –ø—Ä–∏ –∑–º–µ–Ω—à–µ–Ω–Ω—ñ –ø–∞—Ä—Ç–∏—Ü—ñ–π
- –ú–æ–Ω—ñ—Ç–æ—Ä—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –ø–∞–º'—è—Ç—ñ –ø—Ä–∏ –∫–µ—à—É–≤–∞–Ω–Ω—ñ
- –†–æ–∑–≥–ª—è–Ω—å—Ç–µ `persist(StorageLevel.MEMORY_AND_DISK)` –¥–ª—è –≤–µ–ª–∏–∫–∏—Ö –¥–∞—Ç–∞—Å–µ—Ç—ñ–≤
